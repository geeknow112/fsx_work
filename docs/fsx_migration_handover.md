# FSx移行プロジェクト 引継ぎ資料

## 引継ぎ概要
- **作成日**: 2025年8月2日
- **プロジェクト**: Amazon FSx SSD→HDD移行
- **現在のステータス**: 計画完了、実施待ち

## プロジェクト背景

### 検討開始の経緯
- FSxのコスト最適化要求
- 現在の使用率が極めて低い（スループット0.25%）
- 年額約320万円の運用コストの削減検討

### 重要な決定事項
- **コスト重視70% vs パフォーマンス重視30%** の方針
- **HDDの承認取得済み**（承認変更コスト回避のため）
- **切り替えオプション保持**（SSD Single-AZ）

## 現在の環境情報

### 対象システム
```bash
ファイルシステムID: fs-0b2d61a3f2654a9a3
名前: SV-FILE
リージョン: ap-northeast-1
プロファイル: your-profile
```

### 現在の構成詳細
```bash
容量: 7.2TB SSD
スループット: 32 MB/s
デプロイ: Multi-AZ
IOPS: 21,600 (自動設定)
バックアップ: 30日保持、16:00開始
月額料金: 約318,120円
```

### 使用状況（重要）
```bash
スループット使用率: 0.25%（極めて低い）
アクセスパターン: 読み取り重視、平日中心
日次データ量: 約7.38GB
ピーク時間: 平日日中
```

## 移行計画詳細

### 移行先構成
```bash
容量: 7.2TB HDD
スループット: 16 MB/s（最適化後）
デプロイ: Multi-AZ
予想月額料金: 約196,080円
削減効果: 月額122,040円
```

### 作業手順概要
1. **事前準備**: バックアップ強化、テンプレート準備
2. **HDD FSx構築**: 新規システム作成
3. **データ移行**: オンライン移行（8-12時間）
4. **動作確認**: 3-5日間の並行稼働
5. **切り替え**: DNS変更、旧システム削除

## 技術的な重要ポイント

### データ移行戦略
- **オンライン移行**: 業務停止時間最小化
- **並列処理**: DataSync複数タスクで高速化
- **段階的移行**: 重要データ優先
- **差分同期**: 初回フル + 差分更新

### 性能影響の想定
```bash
レイテンシ: 1ms → 3-5ms
IOPS: 21,600 → 7,200
体感影響: 大容量ファイルで明確な遅延
許容判断: 現在の使用パターンでは軽微
```

### 切り替えオプション
```bash
問題発生時: HDD → SSD Single-AZ
削減効果: 年額190万円（より大きな削減）
作業内容: 同様のデータ移行（経験活用）
```

## 実施時の注意事項

### 必須確認事項
- [ ] 各AWS操作前の承認取得
- [ ] 業務時間外での作業実施
- [ ] 関係者への事前通知（1週間前）
- [ ] バックアップ取得確認

### リスク管理
- [ ] ロールバック手順の準備
- [ ] 24時間監視体制の確立
- [ ] エスカレーション連絡先の明確化
- [ ] 緊急時対応手順の整備

## 使用するスクリプト・テンプレート

### 既存スクリプト
```bash
./scripts/fsx_describe.sh          # 現状確認
./scripts/fsx_performance_monitor.sh  # 性能監視
./scripts/fsx_create.sh            # 新規作成
```

### 作成予定テンプレート
```bash
templates/fsx_hdd_template.json           # HDD用
templates/fsx_ssd_single_az_template.json # 切り替え用
```

## コスト試算詳細

### 削減効果
```bash
ストレージ料金削減: 108,000円/月
バックアップ料金削減: 8,100円/月
スループット最適化: 5,940円/月
合計月額削減: 122,040円/月
年額削減: 1,464,480円/年
```

### 一時的追加コスト
```bash
並行稼働期間（3日）: 約53,000円
最終バックアップ: 約12,600円
合計一時コスト: 約65,600円
投資回収期間: 約0.5ヶ月
```

## 再開時のチェックリスト

### 環境確認
- [ ] 現在のFSx状況確認（変更がないか）
- [ ] AWS CLI接続確認
- [ ] 必要な権限確認
- [ ] スクリプト動作確認

### 計画見直し
- [ ] 使用状況の再確認（変化がないか）
- [ ] コスト試算の更新
- [ ] スケジュール調整
- [ ] 関係者の確認

### 実施準備
- [ ] 最終承認の取得
- [ ] 作業時間の調整
- [ ] 監視体制の確立
- [ ] 緊急連絡先の確認

## 関連ドキュメント

### 分析資料
- `docs/fsx_current_status.md` - 現在の構成詳細
- `docs/fsx_cost_analysis.md` - コスト分析
- `docs/fsx_performance_analysis.md` - 性能分析
- `docs/fsx_analysis_summary.md` - 分析サマリー

### 作業用資料
- `docs/fsx_migration_summary.md` - 移行計画サマリー
- `scripts/` - 実行スクリプト
- `templates/` - 作成用テンプレート

## 連絡・エスカレーション

### 技術的問題
- AWS操作でエラーが発生した場合
- 想定以上の性能劣化が発生した場合
- データ移行で問題が発生した場合

### 業務的問題
- ユーザーからの苦情が多発した場合
- 業務に重大な影響が発生した場合
- 承認プロセスで問題が発生した場合

## 最終確認事項

### プロジェクト再開前
1. この引継ぎ資料の内容確認
2. 現在の環境状況の再確認
3. 関係者との調整
4. 最新のAWS料金体系確認

### 実施判断基準
- 技術的準備完了
- 業務的承認取得
- スケジュール調整完了
- リスク対策準備完了

---
**重要**: このプロジェクトは大幅なコスト削減効果（年額約146万円）が期待できる一方、性能影響もあるため、慎重な実施が必要です。問題発生時の切り替えオプション（SSD Single-AZ）も準備済みです。
